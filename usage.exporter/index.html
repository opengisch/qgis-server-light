
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../usage.worker.docker/">
      
      
        <link rel="next" href="../usage.interface/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>Usage of Exporter - QGIS-Server-Light</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.35f28582.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#generate-qgis-project-config" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="QGIS-Server-Light" class="md-header__button md-logo" aria-label="QGIS-Server-Light" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QGIS-Server-Light
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Usage of Exporter
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="QGIS-Server-Light" class="md-nav__button md-logo" aria-label="QGIS-Server-Light" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    QGIS-Server-Light
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../general_idea/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General Idea
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../prerequisites/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prerequisites
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Usage of Worker
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Usage of Worker
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage.worker.cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CLI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage.worker.local/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Local-DEV
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage.worker.docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker-DEV
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Usage of Exporter
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Usage of Exporter
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#generate-qgis-project-config" class="md-nav__link">
    <span class="md-ellipsis">
      Generate QGIS Project config
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Generate QGIS Project config">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-the-cli" class="md-nav__link">
    <span class="md-ellipsis">
      Using the CLI
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using the CLI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supported-qgis-project-extensions" class="md-nav__link">
    <span class="md-ellipsis">
      Supported QGIS project extensions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supported-output-formats" class="md-nav__link">
    <span class="md-ellipsis">
      Supported output formats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unify-layer-names" class="md-nav__link">
    <span class="md-ellipsis">
      Unify layer names
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage.interface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage of interface
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dev the project
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ApiDoc
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            ApiDoc
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../interface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../worker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Worker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../exporter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Exporter
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#generate-qgis-project-config" class="md-nav__link">
    <span class="md-ellipsis">
      Generate QGIS Project config
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Generate QGIS Project config">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-the-cli" class="md-nav__link">
    <span class="md-ellipsis">
      Using the CLI
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Using the CLI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supported-qgis-project-extensions" class="md-nav__link">
    <span class="md-ellipsis">
      Supported QGIS project extensions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supported-output-formats" class="md-nav__link">
    <span class="md-ellipsis">
      Supported output formats
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unify-layer-names" class="md-nav__link">
    <span class="md-ellipsis">
      Unify layer names
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Usage of Exporter</h1>

<h2 id="generate-qgis-project-config">Generate QGIS Project config</h2>
<p>By separating QGIS project information from the servers runtime we save a lot of headaches and be sure to
have the server know only what it should know. With that we minimize the amount of potential bugs drastically.
There is another idea embedded here. Thinking of a big amount of QGIS projects with a ton of layer in each
served by 4 instances of QGIS-Server (in a classical setup) for load balancing reasons as WMS. This means each
server has to solve several tasks (Capabilities, Rendering, LayerTree knowledge etc.). Not only that rendering
a WMS request does not need any knowledge of a tree structure but a one dimensional ordered stacking list
of layers. Serving the capabilities with lets say a permission system is not being implemented easily.</p>
<p>However, this comes with a downside:</p>
<ul>
<li>We need to extract this information from a QGIS-Project to feed the server with it at runtime to empower it
  for rendering our requested layers.</li>
</ul>
<p>QGIS-Server-Light gives you a typed way
(<a href="src/qgis_server_light/interface">python lib</a>) to store extracted information of a QGIS project. This is
what you can use programmatically in your 3rd party application. In addition, it offers a
<a href="src/qgis_server_light/exporter/cli.py">CLI</a> to just do a command line call to extract the information.</p>
<h3 id="using-the-cli">Using the CLI</h3>
<p>You can extract information of a QGIS-Project like this:</p>
<div class="highlight"><pre><span></span><code>.venv/bin/python3<span class="w"> </span>-m<span class="w"> </span>qgis_server_light.exporter.cli<span class="w"> </span>--project<span class="w"> </span><span class="o">[</span>path-to-your-project<span class="o">]</span>
</code></pre></div>
<p>This uses the default output format <code>json</code> and does not <code>unify layer names</code> in the project.</p>
<table>
<thead>
<tr>
<th><img alt="❗" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2757.svg" title=":exclamation:" />  This command writes to stdout!</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>If you want to save the output to a file, you can do by:</p>
<div class="highlight"><pre><span></span><code>.venv/bin/python3<span class="w"> </span>-m<span class="w"> </span>qgis_server_light.exporter.cli<span class="w"> </span>--project<span class="w"> </span><span class="o">[</span>path-to-your-project<span class="o">]</span><span class="w"> </span>&gt;<span class="w"> </span>project_config.json
</code></pre></div>
<h4 id="supported-qgis-project-extensions">Supported QGIS project extensions</h4>
<ul>
<li><code>qgs</code></li>
<li><code>qgz</code></li>
</ul>
<h4 id="supported-output-formats">Supported output formats</h4>
<p><code>--output_format</code></p>
<ul>
<li><code>json</code> (default)</li>
<li><code>xml</code></li>
</ul>
<h4 id="unify-layer-names">Unify layer names</h4>
<p><code>--unify_layer_names_by_group</code></p>
<ul>
<li><code>False</code> (default)</li>
<li><code>True</code></li>
</ul>
<p>There is an option <code>unify_layer_names_by_group</code>. It allows you to reflect the structure of your tree in the
layer names.</p>
<p>Let's say you have a tree structure like that:
<div class="highlight"><pre><span></span><code>environment
├── ground_coverage
│   ├── forest
│   ├── field
│   └── lake
└── forest
</code></pre></div></p>
<p>And presume it is the layer names we see. So the short name which is the name used for exposition to WMS.
This would end up in forest being not addressable in a WMS request easily unless we would use the layer id
of QGIS project layer. But this is not so nicely read in the capabilities in the end.</p>
<p>So enabling this option, will produce the following names for the layers:</p>
<ul>
<li><code>environment.forest</code></li>
<li><code>environment.ground_coverage.forest</code></li>
<li><code>environment.ground_coverage.field</code></li>
<li><code>environment.ground_coverage.lake</code></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.56dfad97.min.js"></script>
      
    
  </body>
</html>